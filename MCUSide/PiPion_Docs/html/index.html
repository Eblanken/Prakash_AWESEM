<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AWESEM: AWESEM MCU Firmware</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AWESEM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">AWESEM MCU Firmware </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Description</h1>
<p>This firmware acts as an analog front-end for the AWESEM program. The MCU both serves to generate the driving waveform for the sample stage with the on-board DAC and samples intensity data.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Installation</h1>
<p>This program is intended for the Teensy 3.6 board from PJRC. Make sure that you have Teensyduino installed. Open and compile the file "PiPion.ino" with the Arduino IDE.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Serial Commands</h1>
<p>These are all of the commands that can be used with the MCU frontend. Note that all commands that set waveform and data acquisition parameters must be executed while the device is not running (after startup or after calling 'H' (halt)).</p>
<p>All command strings are of the format:</p>
<p><a href="https://www.codecogs.com/eqnedit.php?latex=$\{\text{byte}_1,&space;\text{byte}_2,&space;[\text{byte}_3...\text{byte}_n&space;(\text{datatype}_1)],&space;[\text{byte}_{n&plus;1}&space;...\text{byte}_m&space;(\text{datatype}_2&space;)]\}$" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{byte}_1,&space;\text{byte}_2,&space;[\text{byte}_3...\text{byte}_n&space;(\text{datatype}_1)],&space;[\text{byte}_{n&plus;1}&space;...\text{byte}_m&space;(\text{datatype}_2&space;)]\}$" alt="" title="$\{\text{byte}_1, \text{byte}_2, [\text{byte}_3...\text{byte}_n (\text{datatype}_1)], [\text{byte}_{n+1} ...\text{byte}_m (\text{datatype}_2 )]\}$" class="inline"/></a></p>
<h3><a class="anchor" id="autotoc_md4"></a>
Ping</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;p&#39;}\}$" alt="" title="$\{\text{&apos;p&apos;}\}$" class="inline"/> <br  />
 Response: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md5"></a>
Get frequency</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;f&#39;},&space;[\text{axis&space;(uint8\_t)}]\}$" alt="" title="$\{\text{&apos;f&apos;}, [\text{axis (uint8\_t)}]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> then <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{[\text{Frequency&space;Hz&space;(float)}]\}$" alt="" title="$\{[\text{Frequency Hz (float)}]\}$" class="inline"/>, otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md6"></a>
Set Frequency</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;},&space;[text{channel&space;either&space;0&space;or&space;1&space;(uint8\_t)}],&space;[frequency&space;(float)]\}$" alt="" title="$\{\text{&apos;F&apos;}, [text{channel either 0 or 1 (uint8\_t)}], [frequency (float)]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{&#39;A&#39;\}$" alt="" title="$\{&apos;A&apos;\}$" class="inline"/> otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{&#39;F&#39;\}$" alt="" title="$\{&apos;F&apos;\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md7"></a>
Get VPP Range</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;m&#39;},&space;[\text{axis&space;(uint8\_t)}]\}$" alt="" title="$\{\text{&apos;m&apos;}, [\text{axis (uint8\_t)}]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{&#39;A&#39;\}$" alt="" title="$\{&apos;A&apos;\}$" class="inline"/> then <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{[\text{VPP&space;in&space;volts&space;(float)\}]\}}$" alt="" title="$\{[\text{VPP in volts (float)\}]\}}$" class="inline"/>, otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{&#39;F&#39;\}$" alt="" title="$\{&apos;F&apos;\}$" class="inline"/>. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md8"></a>
Set VPP Range</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;M&#39;},&space;[\text{axis&space;(uint8\_t)}],&space;[\text{magnitude&space;(float)}]\}$" alt="" title="$\{\text{&apos;M&apos;}, [\text{axis (uint8\_t)}], [\text{magnitude (float)}]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md9"></a>
Get Sample Frequency</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;s&#39;}\}$" alt="" title="$\{\text{&apos;s&apos;}\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> than <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{[\text{Sampling&space;Frequency&space;Hz&space;(float)}]\}$" alt="" title="$\{[\text{Sampling Frequency Hz (float)}]\}$" class="inline"/>, otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/>. </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md10"></a>
Set Sample Frequency</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;S&#39;},&space;[\text{frequency&space;(float)}]\}$" alt="" title="$\{\text{&apos;S&apos;}, [\text{frequency (float)}]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md11"></a>
Get Sample Averages</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\text{\{&#39;u&#39;\}}$" alt="" title="$\text{\{&apos;u&apos;\}}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> than <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{[\text{samples&space;averages&space;(uint8\_t)}]\}$" alt="" title="$\{[\text{samples averages (uint8\_t)}]\}$" class="inline"/>, otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md12"></a>
Set Sample Averages</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;U&#39;},&space;[\text{averages&space;(uint8\_t)}]\}$" alt="" title="$\{\text{&apos;U&apos;}, [\text{averages (uint8\_t)}]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md13"></a>
Get Current Waveform</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{&#39;w&#39;,&space;[channel&space;0&space;or&space;1&space;(uint8\_t)]\}$" alt="" title="$\{&apos;w&apos;, [channel 0 or 1 (uint8\_t)]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> than <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{[\text{0&space;=&space;Sine,&space;1&space;=&space;Sawtooth,&space;3&space;=&space;Triangle&space;(uint8\_t)}]\}$" alt="" title="$\{[\text{0 = Sine, 1 = Sawtooth, 3 = Triangle (uint8\_t)}]\}$" class="inline"/>, otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md14"></a>
Set Current Waveform</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;W&#39;},&space;[\text{axis&space;0&space;or&space;1&space;(uint8\_t)}],&space;[\text{waveform&space;(0&space;sine,&space;1&space;saw,&space;3&space;tria,&space;4&space;arbitrary)&space;(uint8\_t)}]\}$" alt="" title="$\{\text{&apos;W&apos;}, [\text{axis 0 or 1 (uint8\_t)}], [\text{waveform (0 sine, 1 saw, 3 tria, 4 arbitrary) (uint8\_t)}]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md15"></a>
Set Arbitrary Waveform Data</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;D&#39;},&space;[\text{axis&space;0&space;or&space;1&space;(uint8\_t)}],&space;[\text{samples&space;(int16\_t[256])}]\}$" alt="" title="$\{\text{&apos;D&apos;}, [\text{axis 0 or 1 (uint8\_t)}], [\text{samples (int16\_t[256])}]\}$" class="inline"/> <br  />
 Response: If valid <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md16"></a>
Request Buffer</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> <br  />
 Response: If ready <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> then <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{[\text{scan&space;ID&space;since&space;start&space;(uint8\_t)}],&space;[\text{scan&space;period&space;uS&space;(uint16\_t)}],&space;[\text{time&space;since&space;last&space;waveform&space;rollover&space;of&space;0&space;in&space;uS&space;(uint16\_t)}],&space;[\text{rollover&space;of&space;1&space;in&space;uS&space;(uint16\_t)}],&space;[\text{data&space;payload&space;(uint8\_t[BUFFER\_SIZE])}]\}$" alt="" title="$\{[\text{scan ID since start (uint8\_t)}], [\text{scan period uS (uint16\_t)}], [\text{time since last waveform rollover of 0 in uS (uint16\_t)}], [\text{rollover of 1 in uS (uint16\_t)}], [\text{data payload (uint8\_t[BUFFER\_SIZE])}]\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md17"></a>
Begin</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;B&#39;}\}$" alt="" title="$\{\text{&apos;B&apos;}\}$" class="inline"/> <br  />
 Response: If start is successful <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
<h3><a class="anchor" id="autotoc_md18"></a>
Halt</h3>
<blockquote class="doxtable">
<p>Call: <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;H&#39;}\}$" alt="" title="$\{\text{&apos;H&apos;}\}$" class="inline"/> <br  />
 Response: If pause is successful <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;A&#39;}\}$" alt="" title="$\{\text{&apos;A&apos;}\}$" class="inline"/> otherwise <img src="https://latex.codecogs.com/gif.latex?\inline&space;$\{\text{&#39;F&#39;}\}$" alt="" title="$\{\text{&apos;F&apos;}\}$" class="inline"/> </p>
</blockquote>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
